# Supplementary material (code) for Finite element simulation of ionic electrodiffusion in cellular geometries
_________________

[![GPL-3.0](https://img.shields.io/github/license/adajel/fem_electrodiffusion_cellular_geometries)](LICENSE)
[Read Latest Documentation](https://adajel.github.io/fem_electrodiffusion_cellular_geometries/)
_________________

------------------------------------------------------------------------------
Project description
------------------------------------------------------------------------------
This directory contains an implementation of a Mortar element FEM method
for the solving the KNP-EMI model and the EMI model.

------------------------------------------------------------------------------
Dependencies
------------------------------------------------------------------------------
To get the environment needed (all dependencies etc.) to run the code, download
the docker container by running:

docker run -t -v $(pwd):/home/fenics -i ceciledc/fenics_mixed_dimensional:13-03-20

All meshes are generates automatically in the code where they are used, if they
do not already exist.

------------------------------------------------------------------------------
Running the code
------------------------------------------------------------------------------
To run all the numerical experiments, execute:

$ python3 main.py

Each numerical experiments can be run by the run_*.py files, i.e. to run the
method of manufactured solutions test, execute:

$ python3 run_MMM_test.py

------------------------------------------------------------------------------
Generate figures
------------------------------------------------------------------------------
To generate the figures (.svg format) presented in the paper, execute:

$ python3 make_figures.py

------------------------------------------------------------------------------
Files
------------------------------------------------------------------------------
main.py:
    Script for running all simulations presented in paper, that is:
    - run_refinement_test.py
    - run_test_MMS.py
    - run_2D_axonspy
    - run_3D_axonbundle.py

    In addition, the script generates figures (as in the paper) in .svg format:
    - make_figures.py 
    and converts the figures to .pdf and .pdf_latex format:
    - convert.sh

run_refinement_test.py:
    Run convergence test using refined 2D meshes with one neuron
    - mesh generated by 'make_mesh_refinement_test.py'

run_MMS_test.py:
    Run method of manufactured solutions (MMS) test on unit square
    - mesh generated by 'make_mesh_MMS.py'

run_2D_axons.py:
    Run simulations to compare the EMI and the KNP-EMI model on mesh with one
    and two intracellular compartment
    - mesh generated by 'make_mesh_one_neuron_2D.py'
    - mesh generated by 'make_mesh_two_neurons_2D.py'
    - mesh generated by 'make_mesh_two_neurons_wide_2D.py'

run_3D_axonbundle.py:
    Run physiological simulation to explore ephaptic coupling in idealized
    3D neuron bundle mesh
    - mesh generated by 'make_mesh_axonbundle_3D.py'

solver.py:
    Contains class for a FEM solver for the KNP-EMI problem

solver_emi.py:
    Contains class for a FEM solver for the EMI problem

utils.py:
    Contains class for setting up exact solutions, boundary terms, source terms
    and initial conditions for the method of manufactured solutions (MMS) test.

make_mesh_refinement.py:
    Generates meshes for refinement test (run_refinement_test.py)

make_mesh_one_neuron_2D.py:
    Generates meshes of the MMS test (run_MMS_test.py)

make_mesh_two_neurons_2D.py:
    Generates meshes of a 2D axon (run_2D_axons.py)

make_mesh_two_neurons_wide_2D.py:
    Generates meshes of a 2D axon (run_2D_axons.py)

make_mesh_axonbundle_3D.py
    Generates meshes of a 3D axonbundle with 9 axons (run_3D_axons.py)

make_figures.py
    generates figures displaying results from simulations in .svg format
